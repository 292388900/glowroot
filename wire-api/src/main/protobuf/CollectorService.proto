syntax = "proto3";

import "Trace.proto";
import "Aggregate.proto";
import "GaugeValue.proto";
import "LogEvent.proto";

package org_glowroot_wire_api_model;

option java_package = "org.glowroot.wire.api.model";

service CollectorService {
  rpc hello(Hello) returns (EmptyMessage);
  rpc collectConfig(ConfigMessage) returns (EmptyMessage);
  rpc collectJvmInfo(JvmInfoMessage) returns (EmptyMessage);
  rpc collectAggregates(AggregateMessage) returns (EmptyMessage);
  rpc collectGaugeValues(GaugeValueMessage) returns (EmptyMessage);
  rpc collectTrace(TraceMessage) returns (EmptyMessage);
  rpc log(LogMessage) returns (EmptyMessage);
}

message Hello {
  string server_id = 1;
  repeated string secondary_rollup = 2;
}

message ConfigMessage {
  string server_id = 1;
  string config_json = 2;
}

message JvmInfoMessage {
  string server_id = 1;
}

message AggregateMessage {
  string server_id = 1;
  int64 capture_time = 2;
  repeated OverallAggregate overall_aggregate = 3;
  repeated TransactionAggregate transaction_aggregate = 4;
}

message GaugeValueMessage {
  string server_id = 1;
  repeated GaugeValue gauge_values = 2;
}

message TraceMessage {
  string server_id = 1;
  Trace trace = 2;
}

message LogMessage {
  string server_id = 1;
  LogEvent log_event = 2;
}

message EmptyMessage {}
