<!--
  Copyright 2014-2015 the original author or authors.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<div class="panel panel-default">
  <div class="panel-heading">
    <h2>Gauges</h2>
  </div>
  <div class="panel-body">
    <div ng-include src="'template/gt-loading-overlay.html'"></div>
    <div ng-include src="'template/gt-http-error-overlay.html'"></div>
    <div ng-show="loaded">
      <div ng-hide="allGauges.length" style="font-size: 16px; margin-top: 20px;">
        No gauges configured. See <a href="config/gauges">Gauge configuration</a>.
      </div>
      <div ng-show="allGauges.length">
        <div ng-form
             gt-form-with-primary-button
             style="margin-bottom: 10px;">
          <div class="form-group"
               style="margin-bottom: 0;">
            <label class="control-label pull-left"
                   for="filterDate"
                   style="padding: 7px 10px 0 40px; vertical-align: middle;">
              Date
            </label>

            <div class="pull-left" style="padding: 0 8px 0 4px; width: 10em;">
              <div gt-datepicker
                   gt-model="filterDate"
                   gt-id="filterDate">
              </div>
            </div>
            <div gt-button
                 gt-label="Refresh"
                 gt-click="refreshButtonClick(deferred)"
                 gt-no-spinner="true"
                 id="refreshButtonContainer">
            </div>
          </div>
        </div>
        <!-- z-index 800 is needed to keep the buttons in front of the chart spinner overlay -->
        <div class="clearfix" style="position: relative; z-index: 800;">
          <div class="pull-right" style="margin-top: -20px; margin-bottom: -8px; font-size: 22px;">
            <button class="gt-chart-button"
                    ng-click="zoomOut()"
                    style="border: none;">
              <i title="Zoom out"
                 class="fa fa-search-minus"></i>
            </button>
            <button class="gt-chart-button"
                    ng-click="refreshButtonClick()"
                    style="border: none;">
              <i title="Refresh"
                 class="fa fa-refresh"></i>
            </button>
            <button popover-window="template/help/chart.html"
                    popover-window-placement="left"
                    popover-window-trigger="focus"
                    class="gt-chart-button"
                    style="border: none;">
              <i title="Help"
                 class="fa fa-question-circle"></i>
            </button>
          </div>
        </div>
        <div class="gt-chart-container">
          <div gt-spinner
               gt-show="showChartSpinner"
               gt-no-delay="true"
               class="gt-panel-overlay gt-chart-panel"
               id="chartSpinner">
          </div>
          <div class="gt-chart-dimensions" id="chart"></div>
          <div ng-show="chartNoData && !showChartSpinner"
               class="gt-chart-panel"
               style="display: table;">
            <div style="display: table-cell; text-align: center; vertical-align: middle;">
              <div ng-if="keyedColorPool.keys().length" class="gt-chart-no-data">No data</div>
              <div ng-if="!keyedColorPool.keys().length" class="gt-chart-no-data">Select one or more gauges below</div>
            </div>
          </div>
        </div>

        <div style="padding: 0 20px;">
          <div class="legend" id="chartLegend"
               ng-hide="chartNoData"
               style="text-align: center; margin-top: 10px; width: 100%;">
            <div class="gt-inline-block">
              <div class="gt-inline-block" ng-repeat="seriesLabel in seriesLabels"
                   style="margin: 0 6px;">
                <div class="legendColorBox gt-inline-block"
                     style="border: 1px solid rgb(204, 204, 204); padding: 1px;">
                  <div style="width: 4px; height: 0px; border: 5px solid rgb(237, 194, 64); overflow: hidden;"
                       ng-style="{'border': '5px solid ' + seriesLabel.color}">
                  </div>
                </div>
                <div class="legendLabel gt-inline-block">{{seriesLabel.text}}</div>
              </div>
            </div>
          </div>
          <br>

          <table class="gt-gauge-table"
                 style="margin-top: 10px;">
            <thead>
            <tr>
              <th style="padding-left: 20px; width: 70%;">
                Gauge
              </th>
              <th style="width: 100px;">
                Color
              </th>
              <th style="min-width: 120px;">
                Scale
              </th>
              <th style="padding-left: 0;">
                Display&nbsp;&#916;y
              </th>
            </tr>
            </thead>
            <tbody>
            <tr>
              <td style="padding: 8px 20px 5px 20px;">
                <input type="text"
                       class="form-control gt-inline-block"
                       ng-model="gaugeFilter"
                       placeholder="filter the gauge list">
              </td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr ng-repeat="gauge in allGauges | filter:{display: gaugeFilter}">
              <td style="padding-left: 0;">
                <div class="checkbox gt-gauge-second-line-indent" style="margin-top: 0; margin-bottom: 0;">
                  <label ng-style="gaugeNameStyle(gauge.name)">
                    <input type="checkbox" ng-checked="keyedColorPool.get(gauge.name)"
                           ng-click="clickGaugeName(gauge.name)"
                           id="{{gauge.name}}">
                    {{lineBreakableGaugeName(gauge.display)}}
                  </label>
                </div>
              </td>
              <td>
                <div ng-style="gaugeColorStyle(gauge.name)">{{gaugeColorText(gauge.name)}}</div>
              </td>
              <td>
                <div ng-show="hasGaugeScale(gauge.name)">
                  {{getGaugeScale(gauge.name)}}
                </div>
              </td>
              <td style="padding-left: 0; text-align: center;">
                <button class="gt-chart-button"
                        ng-show="hasGaugeScale(gauge.name)"
                        ng-click="toggleDelta(gauge.name)"
                        ng-style="deltaStyle(gauge.name)">
                  <i class="fa fa-check-circle"
                     style="font-size: 16px;"></i>
                </button>
              </td>
            </tr>
            </tbody>
          </table>
          <div style="margin-top: 20px; padding-left: 20px;">
            <button class="btn btn-default"
               gt-click-and-blur="selectAllGauges()">
              select all {{!showingAllGauges() ? 'showing' : ''}}
            </button>
            <button class="btn btn-default"
               gt-click-and-blur="deselectAllGauges()"
               style="margin-left: 5px;">
              deselect all {{!showingAllGauges() ? 'showing' : ''}}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
