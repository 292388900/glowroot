<!doctype html>
<!--
  Copyright 2012 the original author or authors.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Informant | Misc</title>
<link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="stylesheet" href="libs/bootstrap/2.1.1/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="css/informant.css" type="text/css" />
<script type="text/javascript" src="libs/jquery/1.8.1/jquery.min.js"></script>
<!-- bootstrap.min.js is used by ajax error handler to throw up modal dialog -->
<script type="text/javascript" src="libs/bootstrap/2.1.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="libs/spin/1.2.6/spin.min.js"></script>
<script type="text/javascript" src="js/informant.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    configureAjaxError()
    var postingClearData = false
    $('#clearButton').click(function() {
      // handling crazy user clicking on the button
      if (postingClearData) return
      postingClearData = true
      var keepMillis = $('input:radio[name=keepMillis]:checked').val()
      var compact = $('#compact').is(':checked')
      $.post('misc/cleardata?keepMillis=' + keepMillis + '&compact=' + compact, function() {
        postingClearData = false
        hideSpinner('#clearButtonSpinner')
        showAndFadeSuccessMessage('#clearSuccessMessage')
      })
      // in case button is clicked again before success message is hidden
      $('#clearSuccessMessage').hide()
      showSpinner('#clearButtonSpinner')
    })
  })
</script>
</head>
<body>
  <h1 class="header">
    <a class="header-logo" href=".">Informant</a><span class="header-page-name">Misc</span>
    <span class="header-see-also">
      see also: <a href="traces.html">trace explorer</a>,
      <a href="configuration.html">configuration</a>
    </span>
  </h1>
  <div style="vertical-align: middle; font-size: 19px">Clear data</div>
  <br>
  <form class="well form-horizontal" style="margin-left: 40px">
    <fieldset>
      <div class="control-group">
        <label class="control-label" for="keepMillis">Keep</label>
        <div class="controls">
          <label class="radio">
            <input type="radio" name="keepMillis" value="2419200000" checked> Last 4 weeks
          </label>
          <label class="radio">
            <input type="radio" name="keepMillis" value="604800000"> Last 7 days
          </label>
          <label class="radio">
            <input type="radio" name="keepMillis" value="86400000"> Last 24 hours
          </label>
          <label class="radio">
            <input type="radio" name="keepMillis" value="3600000"> Last 60 minutes
          </label>
          <label class="radio">
            <input type="radio" name="keepMillis" value="0"> None
          </label>
        </div>
      </div>
      <div class="control-group">
        <label class="control-label" for="compact">Compact</label>
        <div class="controls">
          <input type="checkbox" id="compact" value="true">
          <div class="help-block">
            Compact the H2 data file that stores the trace summary data (capture time,
            duration, description, user ID, attributes, metrics)
          </div>
        </div>
      </div>
      <div class="form-actions">
        <button type="button" class="btn" id="clearButton">Clear data</button>
        <div class="button-spinner" id="clearButtonSpinner"></div>
        <div class="button-success-message" id="clearSuccessMessage">Cleared</div>
      </div>
    </fieldset>
  </form>
  <div style="vertical-align: middle; font-size: 19px">Thread dump</div>
  <br>
  <div class="well form-horizontal" style="margin-left: 40px">
    <button type="button" class="btn" onclick="location.href = 'threaddump.html'">
      Full thread dump
    </button>
  </div>
</body>
</html>
