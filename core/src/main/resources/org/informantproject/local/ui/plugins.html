<!doctype html>
<!--
  Copyright 2012 the original author or authors.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Informant | Plugins</title>
<link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="stylesheet" href="libs/bootstrap/2.1.1/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="css/informant.css" type="text/css" />
<script type="text/javascript" src="libs/jquery/1.8.1/jquery.min.js"></script>
<!-- bootstrap.min.js is used by ajax error handler to throw up modal dialog -->
<script type="text/javascript" src="libs/bootstrap/2.1.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="libs/handlebars/1.0.0.beta.6/handlebars.js"></script>
<script type="text/javascript" src="libs/spin/1.2.6/spin.min.js"></script>
<script type="text/javascript" src="js/informant.js"></script>
<style media="screen" type="text/css">
  .table td { vertical-align:middle; }
  .table { width : 900px; }
  .table th { width: 300px; }
</style>
<script type="text/x-handlebars-template" id="packagedTemplate">
  <table class="table table-bordered table-striped">
    <thead>
      <tr><th>Plugin</th><th>Version</th></tr>
    </thead>
    <tbody>
      {{#each .}}
        <tr>
          <td>{{name}}</td>
          <td>{{version}}</td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</script>
<script type="text/x-handlebars-template" id="installedTemplate">
  <table class="table table-bordered table-striped">
    <thead>
      <tr><th>Plugin</th><th>Version</th></tr>
    </thead>
    <tbody>
      {{#each .}}
        <tr>
          <td>{{name}}</td>
          <td>{{version}}</td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</script>
<script type="text/x-handlebars-template" id="installableTemplate">
  <table class="table table-bordered table-striped">
    <thead>
      <tr><th>Plugin</th><th>Version</th></tr>
    </thead>
    <tbody>
      {{#each .}}
        <tr>
          <td>{{name}}</td>
          <td>{{version}}</td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</script>
<script type="text/javascript">
  $(document).ready(function() {
    configureAjaxError()
    var installableSpinner = new Spinner({ lines: 10, width: 4, radius: 8 })
    // small delay so that if there is an immediate page return it doesn't blink
    setTimeout(function() {
      if (installableSpinner) installableSpinner.spin($('#installableSpinner').get(0))
    }, 100)

    var packagedTemplate = Handlebars.compile($('#packagedTemplate').html())
    var installedTemplate = Handlebars.compile($('#installedTemplate').html())
    var installableTemplate = Handlebars.compile($('#installableTemplate').html())

    $.getJSON('plugin/packaged', function(packagedPlugins) {
      if (packagedPlugins.length > 0) {
        $('#packagedSection').show()
        var html = packagedTemplate(packagedPlugins)
        $('#packagedPlugins').html(html)
        $('#installedDescriptionWithoutPackage').hide()
        $('#installedDescriptionWithPackage').show()
      }
    })
    $.getJSON('plugin/installed', function(installedPlugins) {
      var html = installedTemplate(installedPlugins)
      $('#installedPlugins').html(html)
    })
    $.getJSON('plugin/installable', function(installablePlugins) {
      $('#installableSpinner').hide()
      installableSpinner.stop()
      installableSpinner = null
      var html = installableTemplate(installablePlugins)
      $('#installablePlugins').html(html)
    })
  })
</script>
</head>
<body>
  <h1 class="header">
    <a class="header-logo" href=".">Informant</a><span class="header-page-name">Plugins</span>
    <span class="header-see-also">
      see also: <a href="traces.html">trace explorer</a>,
      <a href="configuration.html">configuration</a>
    </span>
  </h1>
  <br>
  <div id="packagedSection" style="display: none">
    <h3>Packaged Plugins</h3>
    <p>
      Plugins that were bundled with informant-core to create this Informant package
    </p>
    <br>
    <div id="packagedPlugins"></div>
    <br>
  </div>
  <h3>Installed Plugins</h3>
  <div id="installedDescriptionWithPackage" style="display: none">
    <p>Additional plugins that were found on the classpath at startup</p>
  </div>
  <div id="installedDescriptionWithoutPackage">
    <p>Plugins that were found on the classpath at startup</p>
  </div>
  <br>
  <div id="installedPlugins"></div>
  <br>
  <h3>Installable Plugins</h3>
  <p>
    Plugins that have been deployed to
    <a href="https://oss.sonatype.org/content/repositories/snapshots/org/informantproject/plugins/">
    Sonatype OSS Maven Repository
    </a>
    (and that are not already installed)</p>
  <br>
  <div id="installablePlugins"></div>
  <div id="installableSpinner" style="width: 40px; height: 60px"></div>
</body>
</html>
